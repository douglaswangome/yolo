# IP3

### hosts

```
# This is an example Ansible inventory file.
# The hosts below are grouped under the 'all' group,
# which is the default group for all hosts in the inventory.

[all]
ansible_host=127.0.0.1 # This host is the local machine.
port=2222 # This is the SSH port for the local machine.
```

### ansible.cfg

```cfg
# This is the main Ansible configuration file.
# It defines global settings for all Ansible runs.

[defaults]
# This specifies the inventory file to use for your hosts.
# It tells Ansible where to find the list of managed nodes.
inventory = hosts

# This is the default user that Ansible will use to connect to remote hosts.
remote_user = vagrant

# This is the path to the SSH private key used for authentication.
# This key is typically generated by Vagrant for its virtual machines.
private_key_file = .vagrant/machines/default/virtualbox/private_key

# This specifies the directory where Ansible will look for roles.
roles_path = ./ansible/roles

# This setting disables host key checking for new connections.
# It's useful for development environments like Vagrant, but
# it's recommended to enable this for production environments.
host_key_checking = False
```

## Roles

This project uses Ansible to automate the deployment of a full-stack application.

### Folder and File Structure Explanation

- **`ansible/`**: This directory contains all the Ansible-related files, including roles.
  - **`roles/`**: This directory holds reusable Ansible roles. Each role is a self-contained unit of automation that is included in a playbook.
    - **`backend_deployment/`**: This role is responsible for deploying the application's backend.
    - **`clone_repo/`**: This role handles cloning the application's source code from a version control repository onto the target server.
    - **`frontend_deployment/`**: This role is dedicated to deploying the application's frontend.
    - **`install_docker/`**: This role installs and configures Docker on the target hosts.
    - **`install_git/`**: This role installs the Git version control system on the target hosts. It's a prerequisite for the `clone_repo` role.
    - **`network_deployment/`**: This role manages network-related docker configurations.
- **`backend/`**: This folder contains the source code for the application's backend.
- **`client/`**: This folder contains the source code for the application's frontend.
- **`.gitignore`**: This file specifies intentionally untracked files that Git should ignore. It helps keep the repository clean by excluding build artifacts, sensitive information, and editor-specific files.
- **`ansible.cfg`**: This is the global configuration file for Ansible. It defines various settings like the inventory file location, the default remote user, and SSH settings.
- **`docker-compose.yaml`**: This file is used to define and run multi-container Docker applications. It specifies the services, networks, and volumes for the application, making it easy to deploy the entire stack with a single command.
- **`EXPLANATION.md`**:
- **`hosts`**: This is the Ansible inventory file. It lists the managed nodes and organizes them into groups. This is where you define the target machines for your Ansible playbook.
- **`image.png`**:
- **`playbook.yaml`**: This is the main Ansible playbook. It orchestrates the entire deployment process by calling the roles in a specific order to build and deploy the application.
- **`README.md`**:
- **`Vagrantfile`**: This file is used by Vagrant to define and configure virtual machines. It specifies the base box, network settings, and provisioners to create a consistent, reproducible development environment.

### Ansible Playbook (`playbook.yaml`)

- **`hosts: all`**: This line specifies that the playbook will run on all hosts defined in our `hosts` inventory file.
- **`become: yes`**: This tells Ansible to use privilege escalation (`sudo`) to run tasks with elevated permissions. This is necessary for system-level changes like installing software or configuring services.
- **`roles:`**: This section lists the Ansible roles that will be executed. The order in which they are listed is crucial, as Ansible executes tasks sequentially from top to bottom.

### Explanation of Role Execution Order

The order of the roles in this playbook is carefully structured to ensure all dependencies are met before a subsequent step is attempted. A playbook runs sequentially, meaning one role's completion is a prerequisite for the next.

1.  **`install_docker`**:

    - **Function**: This role is placed first because our services (backend, frontend) will be deployed using Docker containers. Docker needs to be installed and configured on the target servers before any container-related tasks can be performed.
    - **Reasoning for Position**: It's a foundational dependency. Without Docker, the other roles that interact with containers would fail.

2.  **`install_git`**:

    - **Function**: This role ensures that Git is installed on the target machine. Git is required to clone the application source code from a repository.
    - **Reasoning for Position**: It's an immediate dependency for the `clone_repo` role. You can't clone a repository if Git isn't installed. It's placed after `install_docker` because the order between these two doesn't have a strict dependency, but it's good practice to install fundamental tools first.

3.  **`clone_repo`**:

    - **Function**: This role clones the application's source code from a specified Git repository to a directory on the target host.
    - **Reasoning for Position**: This must run after `install_git` as it depends on Git being present. The cloned code is then used by the `backend_deployment` and `frontend_deployment` roles.

4.  **`network_deployment`**:

    - **Function**: This role configures network-related settings for Docker. This is critical for making the deployed application accessible to the outside world.
    - **Reasoning for Position**: It's best to set up networking after the necessary infrastructure and application code are in place. This allows the network configuration to point to the correct running services and ports.

5.  **`backend_deployment`**:

    - **Function**: This role handles the deployment of the backend application. This typically involves building the application, configuring its environment, and starting it as a service.
    - **Reasoning for Position**: This role depends on the application code being available (from `clone_repo`) and Docker being installed.

6.  **`frontend_deployment`**:
    - **Function**: This role deploys the frontend application.
    - **Reasoning for Position**: Similar to the backend, it depends on the application code (`clone_repo`) and a docker network configured in the `network_deployment` step. It is placed last to ensure all foundational pieces are in place before the user-facing part of the application is deployed.
